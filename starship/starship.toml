# ===================================
# Starship Prompt Configuration
# ===================================
# Cross-platform prompt configuration for Mac and Linux/Sway
# Maintains consistency while supporting platform-specific modules

# Get editor completions based on the config schema
"$schema" = 'https://starship.rs/config-schema.json'

# ===================================
# Format Configuration
# ===================================
format = """
[‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>](bold green)$username$hostname$shlvl$directory$git_branch$git_status$package$golang$python$nodejs$rust$java
[‚îÇ](bold green)$docker_context$cmake$container$kubernetes$terraform$nix_shell
[‚îî‚îÄ>](bold green)$status$character"""

# Inserts a blank line between shell prompts
add_newline = false

# Timeout for commands executed by starship (in milliseconds)
command_timeout = 1000

# ===================================
# Custom Commands
# ===================================
[custom.terminal]
command = "echo $TERM"
when = "true"
format = "[$output]($style) "
style = "bold yellow"

# ===================================
# Core Modules
# ===================================

# Character that appears after the last command prompt
[character]
success_symbol = "[‚ûú](bold green)"
error_symbol = "[‚ûú](bold red)"
vimcmd_symbol = "[‚ùÆ](bold green)"
vimcmd_replace_one_symbol = "[‚ùÆ](bold purple)"
vimcmd_replace_symbol = "[‚ùÆ](bold purple)"
vimcmd_visual_symbol = "[‚ùÆ](bold yellow)"

# Username and hostname
[username]
format = "[$user]($style)@"
style_user = "bold blue"
show_always = false

[hostname]
format = "[$hostname]($style) in "
style = "bold dimmed green"
ssh_only = false
detect_env_vars = ["SSH_CONNECTION", "SSH_CLIENT", "SSH_TTY"]
trim_at = "."

# Shell level indicator
[shlvl]
disabled = false
format = "[$symbol]($style) "
symbol = "‚ÜïÔ∏è "
threshold = 2
repeat = true
style = "bold yellow"

# Directory module
[directory]
truncation_length = 3
truncation_symbol = "‚Ä¶/"
truncate_to_repo = true
format = "[$path]($style)[$read_only]($read_only_style) "
style = "bold cyan"
read_only = " üîí"
read_only_style = "red"
home_symbol = "üè† "

# ===================================
# Version Control
# ===================================

[git_branch]
format = "[$symbol$branch]($style) "
symbol = "üå± "
style = "bold purple"
truncation_length = 20
truncation_symbol = "‚Ä¶"

# ===================================
# Git Status - Nerd Font Icons Configuration
# ===================================
# Three styles available: Material Design (active), Font Awesome, Minimalist
# Switch by commenting/uncommenting the desired [git_status] section

# ORIGINAL EMOJI CONFIGURATION (backup)
# [git_status]
# format = "([\\[$all_status$ahead_behind\\]]($style) )"
# style = "bold red"
# conflicted = "üè≥"
# ahead = "üèéüí®"
# behind = "üò∞"
# diverged = "üòµ"
# up_to_date = "‚úì"
# untracked = "ü§∑"
# stashed = "üì¶"
# modified = "üìù"
# staged = "[++($count)](green)"
# renamed = "üëÖ"
# deleted = "üóë"

# ===================================
# Style 1: Material Design (commented - alternative)
# ===================================
# [git_status]
# format = "([\\[$all_status$ahead_behind\\]]($style) )"
# style = "bold red"
# conflicted = "!"
# ahead = "‚Üë"
# behind = "‚Üì"
# diverged = "‚Üï"
# up_to_date = "‚úì"
# untracked = "?"
# stashed = "‚öë"
# modified = "‚Ä¢"
# staged = "[++($count)](green)"
# renamed = "‚Üí"
# deleted = "‚úó"

# ===================================
# Style 2: Clean Glyphs (ACTIVE - Alternative)
# ===================================
[git_status]
format = "([\\[$all_status$ahead_behind\\]]($style) )"
style = "bold red"
conflicted = "!"
ahead = "‚Üë"
behind = "‚Üì"
diverged = "‚ö°"
up_to_date = "‚úì"
untracked = "?"
stashed = "‚öë"
modified = "‚Ä¢"
staged = "[++($count)](green)"
renamed = "‚Üí"
deleted = "√ó"

# ===================================
# Style 3: Minimalist (commented - alternative)
# ===================================
# [git_status]
# format = "([\\[$all_status$ahead_behind\\]]($style) )"
# style = "bold red"
# conflicted = "‚ö†"
# ahead = "‚á°"
# behind = "‚á£"
# diverged = "‚áÖ"
# up_to_date = "‚úì"
# untracked = "?"
# stashed = "¬ß"
# modified = "‚Ä¢"
# staged = "[++($count)](green)"
# renamed = "‚Üí"
# deleted = "√ó"

# ===================================
# Package Managers
# ===================================

[package]
format = "[$symbol$version]($style) "
symbol = "üì¶ "
style = "bold 208"
display_private = false

# ===================================
# Programming Languages
# ===================================

[golang]
format = "[$symbol($version )]($style)"
symbol = "üêπ "
style = "bold cyan"
detect_extensions = ["go"]
detect_files = ["go.mod", "go.sum", "go.work", "go.work.sum"]
detect_folders = ["go"]

[python]
format = "[${symbol}${pyenv_prefix}(${version} )(\\($virtualenv\\) )]($style)"
symbol = "üêç "
style = "bold yellow"
pyenv_version_name = false
pyenv_prefix = "pyenv "
python_binary = ["python3", "python", "python2"]
detect_extensions = ["py"]
detect_files = ["requirements.txt", ".python-version", "pyproject.toml", "Pipfile", "setup.py", "tox.ini"]
detect_folders = []

[nodejs]
format = "[$symbol($version )]($style)"
symbol = "üìó "
style = "bold green"
detect_extensions = ["js", "mjs", "cjs", "ts", "mts", "cts"]
detect_files = ["package.json", "package-lock.json", "yarn.lock", "pnpm-lock.yaml", "node_modules"]
detect_folders = ["node_modules"]

[rust]
format = "[$symbol($version )]($style)"
symbol = "ü¶Ä "
style = "bold red"
detect_extensions = ["rs"]
detect_files = ["Cargo.toml", "Cargo.lock"]
detect_folders = []

[java]
format = "[${symbol}(${version} )]($style)"
symbol = "‚òï "
style = "bold dimmed red"
detect_extensions = ["java", "class", "jar", "war", "ear"]
detect_files = ["pom.xml", "build.gradle.kts", "build.sbt", ".java-version"]
detect_folders = ["src", "target", "pom.xml"]

# ===================================
# Container and Cloud Tools
# ===================================

[docker_context]
format = "[$symbol$context]($style) "
symbol = "üê≥ "
style = "blue bold"
detect_extensions = []
detect_files = ["docker-compose.yml", "docker-compose.yaml", "Dockerfile", "docker-compose.dev.yml", "docker-compose.ci.yml"]
detect_folders = []

[container]
format = "[$symbol \\[$name\\]]($style) "
symbol = "‚¨¢"
style = "red bold dimmed"

[kubernetes]
format = '[$symbol$context( \($namespace\))]($style) '
symbol = "‚ò∏ "
style = "cyan bold"
disabled = false
detect_files = ["k8s", "kubernetes", "kubeconfig", "k3s", "kubeadm"]
detect_folders = []
detect_extensions = ["yaml", "yml"]

[terraform]
format = "[$symbol$workspace]($style) "
symbol = "üí† "
style = "bold 105"
detect_extensions = ["tf", "tfplan", "tfstate"]
detect_files = [".terraformrc", ".terraform.lock.hcl"]
detect_folders = [".terraform"]

# ===================================
# Build Systems and Tools
# ===================================

[cmake]
format = "[$symbol($version )]($style)"
symbol = "üî® "
style = "bold blue"
detect_extensions = ["cmake"]
detect_files = ["CMakeLists.txt", "CMakeCache.txt"]
detect_folders = []

[nix_shell]
format = '[$symbol$state( \($name\))]($style) '
symbol = "‚ùÑÔ∏è "
style = "bold blue"
impure_msg = "impure"
pure_msg = "pure"
unknown_msg = ""
detect_files = ["shell.nix", "default.nix", "flake.nix"]
detect_dirs = ["nix"]
detect_folders = []

# ===================================
# Command Status
# ===================================

[status]
format = "[$symbol$status]($style) "
symbol = "‚ùå"
success_symbol = ""
style = "bold red"
disabled = false
map_symbol = true

# ===================================
# Platform-Specific Modules
# ===================================

# macOS-specific modules (only show on macOS)
[custom.macos]
command = "uname"
when = "[[ $(uname) == 'Darwin' ]]"
format = "[$output]($style) "
style = "bold dimmed white"

# Linux-specific modules (only show on Linux)
[custom.linux]
command = "uname -o"
when = "[[ $(uname) == 'Linux' ]]"
format = "[$output]($style) "
style = "bold dimmed white"

# Sway-specific indicator (only show in Sway)
[custom.sway]
command = "echo $SWAYSOCK"
when = "[[ -n $SWAYSOCK ]]"
format = "[ü™ü Sway]($style) "
style = "bold magenta"

# ===================================
# Environment Indicators
# ===================================

# Show if in a tmux session
[custom.tmux]
command = "echo $TMUX"
when = "[[ -n $TMUX ]]"
format = "[üì∫ tmux]($style) "
style = "bold blue"

# Show if running in Ghostty (macOS)
[custom.ghostty]
command = "echo $GHOSTTY_RESOURCES"
when = "[[ -n $GHOSTTY_RESOURCES ]]"
format = "[üëª Ghostty]($style) "
style = "bold green"

# Show if running in Foot (Linux Wayland)
[custom.foot]
command = "echo $FOOT_TERMINAL_ID"
when = "[[ -n $FOOT_TERMINAL_ID ]]"
format = "[ü¶∂ Foot]($style) "
style = "bold green"

# ===================================
# Development Environment
# ===================================

# Show current git commit hash
[custom.git_commit]
command = "git rev-parse --short HEAD 2>/dev/null"
when = "git rev-parse --git-dir > /dev/null 2>&1"
format = "[($hash)]($style) "
style = "bold dimmed white"

# Show AWS profile if active
[custom.aws_profile]
command = "echo $AWS_PROFILE"
when = "[[ -n $AWS_PROFILE ]]"
format = "[üîê AWS: $output]($style) "
style = "bold yellow"

# ===================================
# System Information
# ===================================

# Battery indicator (for laptops)
[battery]
format = "[$symbol$percentage]($style) "
full_symbol = "üîã"
charging_symbol = "‚ö°Ô∏è"
discharging_symbol = "üíÄ"
unknown_symbol = "‚ùì"
empty_symbol = "üîå"
disabled = false

[[battery.display]]
threshold = 10
style = "bold red"

[[battery.display]]
threshold = 30
style = "bold yellow"

[[battery.display]]
threshold = 60
style = "bold green"

# Time module
[time]
format = "[$time]($style) "
style = "bold dimmed white"
use_12hr = false
disabled = false

# Memory usage
[custom.memory]
command = """
case $(uname) in
  Darwin)
    # macOS
    vm_stat | perl -ne '/page size of (\\d+)/ and $ps=$1; /Pages free:\\s+(\\d+)/ and $pf=$1; /Pages active:\\s+(\\d+)/ and $pa=$1; /Pages inactive:\\s+(\\d+)/ and $pi=$1; /Pages wired down:\\s+(\\d+)/ and $pw=$1; END { printf \"%.1fGB\", ($pf+$pa+$pi+$pw)*$ps/1024/1024/1024; }'
    ;;
  Linux)
    # Linux
    free -h | awk '/^Mem:/ {print $3}'
    ;;
esac
"""
format = "[üíæ $output]($style) "
style = "bold dimmed blue"
when = "true"

# ===================================
# Network Information
# ===================================

[localip]
ssh_only = false
format = "[$localipv4]($style) "
style = "bold dimmed purple"
disabled = true

# ===================================
# Configuration Notes
# ===================================
# This configuration is designed to:
# 1. Provide consistent experience across macOS and Linux/Sway
# 2. Show platform-specific information when relevant
# 3. Display development environment context
# 4. Maintain visual consistency with Gruvbox Dark theme
# 5. Optimize for performance with appropriate timeouts
#
# Platform-specific modules are conditionally displayed based on:
# - Operating system (Darwin vs Linux)
# - Window manager (Sway detection)
# - Terminal emulator (Ghostty vs Foot)
# - Session management (tmux detection)