# ===================================
# Starship Compact Mode Configuration
# ===================================
# Generated by build-configs.sh - DO NOT EDIT DIRECTLY
# Edit the modular components instead and rebuild

# Get editor completions based on the config schema
"$schema" = 'https://starship.rs/config-schema.json'

# ===================================
# Compact Format Configuration
# ===================================
# Minimal single-line layout for focused work

# Compact format string - single line with essential info only
format = """[$path]($style)[$read_only]($read_only_style)[$git_branch]($style)[$git_status]($style)$character"""

# Blank line between prompts
add_newline = false

# Command timeout
command_timeout = 1000
# ===================================
# Core Base Modules Configuration
# ===================================
# Core modules excluding frequently overridden ones

# Character that appears after the last command prompt
[character]
success_symbol = "[➜](bold green)"
error_symbol = "[➜](bold red)"
vimcmd_symbol = "[❮](bold green)"
vimcmd_replace_one_symbol = "[❮](bold purple)"
vimcmd_replace_symbol = "[❮](bold purple)"
vimcmd_visual_symbol = "[❮](bold yellow)"

# ===================================
# Programming Languages Configuration
# ===================================
# Language-specific modules used across all Starship modes

# Package manager module

# ===================================
# Container and Build Tools Configuration
# ===================================
# Container and build system modules used across all Starship modes

# Docker context module

# ===================================
# Platform-Specific Modules Configuration
# ===================================
# Custom modules for platform detection and development environment

# Custom terminal detection

# ===================================
# System Information Modules Configuration
# ===================================
# System monitoring and status modules

# Battery indicator (for laptops)
[[battery.display]]
threshold = 10
style = "bold red"

[[battery.display]]
threshold = 30
style = "bold yellow"

[[battery.display]]
threshold = 60
style = "bold green"

# Time module

# ===================================
# Base Modules Configuration
# ===================================
# Fundamental modules that don't fit into other categories

# Command status module
[status]
format = "[$symbol$status]($style) "
symbol = "❌"
success_symbol = ""
style = "bold red"
disabled = false
map_symbol = true

# Local IP module (disabled by default)

# ===================================
# GitHub Integration Modules Configuration
# ===================================
# Custom modules for GitHub integration and user information

# GitHub username module - displays first name from GitHub or git config
[custom.github_username]
command = """
#!/bin/bash
# Setup cache directory
CACHE_DIR="${XDG_CACHE_HOME:-$HOME/.cache}/starship-github"
mkdir -p "$CACHE_DIR" 2>/dev/null || CACHE_DIR="/tmp/starship-github-$USER"
mkdir -p "$CACHE_DIR" 2>/dev/null

CACHE_FILE="$CACHE_DIR/github_user_name.cache"
CACHE_TTL=3600  # 1 hour in seconds

# Function to check if cache is fresh
is_cache_fresh() {
    [[ -f "$1" ]] && [[ $(($(date +%s) - $(stat -c %Y "$1" 2>/dev/null || stat -f %m "$1" 2>/dev/null))) -lt $CACHE_TTL ]]
}

# Try GitHub CLI first with caching
if command -v gh &> /dev/null && gh auth status &> /dev/null; then
    # Check cache first
    if is_cache_fresh "$CACHE_FILE"; then
        cached_name=$(cat "$CACHE_FILE" 2>/dev/null)
        if [[ -n "$cached_name" && "$cached_name" != "null" ]]; then
            echo "$cached_name"
            exit 0
        fi
    fi

    # Cache miss or expired - fetch from API
    github_name=$(gh api user --jq .name 2>/dev/null)
    if [[ -n "$github_name" && "$github_name" != "null" ]]; then
        first_name=$(echo "$github_name" | cut -d' ' -f1)
        echo "$first_name" > "$CACHE_FILE" 2>/dev/null
        echo "$first_name"
        exit 0
    fi
fi

# Fallback to git config
git_name=$(git config user.name 2>/dev/null)
if [[ -n "$git_name" ]]; then
    echo "$git_name" | cut -d' ' -f1
    exit 0
fi

# Final fallback to system username
echo "$USER"
"""
when = "true"
format = "[$output]($style)"
style = "bold blue"
show_always = false
description = "Displays GitHub first name or git config first name (cached for 1 hour)"

# GitHub repository status indicator (enhanced)
        [[ -f "$1" ]] && [[ $(($(date +%s) - $(stat -c %Y "$1" 2>/dev/null || stat -f %m "$1" 2>/dev/null))) -lt $CACHE_TTL ]]
    }

    # Check cache first
    if is_cache_fresh "$CACHE_FILE"; then
        cached_info=$(cat "$CACHE_FILE" 2>/dev/null)
        if [[ -n "$cached_info" ]]; then
            echo "$cached_info"
            exit 0
        fi
    fi

    # Cache miss or expired - fetch from API (single combined call)
    repo_info=$(gh repo view --json nameWithOwner,visibility,isFork --jq '.nameWithOwner + " " + .visibility + " " + (if .isFork then "fork" else "origin" end)' 2>/dev/null)
    if [[ -n "$repo_info" ]]; then
        echo "$repo_info" > "$CACHE_FILE" 2>/dev/null
        echo "$repo_info"
    fi
fi
"""
when = "true"
format = "[󰊬 $output]($style) "
style = "dimmed white"
description = "Shows GitHub repository information when in a GitHub repo (cached for 1 hour)"

# ===================================
# Core Overridable Modules Configuration
# ===================================
# Core modules that are frequently overridden in different modes

# System username (disabled - using GitHub username instead)
[username]
disabled = true

# GitHub username module replaces the standard username
# This is defined in github-modules.toml and will be included by the build system

[hostname]
format = "[$hostname]($style) in "
style = "bold dimmed green"
ssh_only = false
detect_env_vars = ["SSH_CONNECTION", "SSH_CLIENT", "SSH_TTY"]
trim_at = "."

# Shell level indicator
[shlvl]
disabled = false
format = "[$symbol]($style) "
symbol = "󰔟 "
threshold = 2
repeat = true
style = "bold yellow"

# Directory module
[directory]
truncation_length = 3
truncation_symbol = "…/"
truncate_to_repo = true
format = "[$path]($style)[$read_only]($read_only_style) "
style = "bold cyan"  # Will be overridden by gruvbox_rainbow palette if active
read_only = " 󰌾"
read_only_style = "red"
home_symbol = "󰋜 "

# Git branch module
[git_branch]
format = "[$symbol$branch]($style) "
symbol = " "
style = "bold purple"  # Will be overridden by gruvbox_rainbow palette if active
truncation_length = 20
truncation_symbol = "…"

# Git status module
[git_status]
format = "([\\[$all_status$ahead_behind\\]]($style) )"
style = "bold red"  # Will be overridden by gruvbox_rainbow palette if active
conflicted = "!"
ahead = "↑"
behind = "↓"
diverged = "⚡"
up_to_date = "✓"
untracked = "?"
stashed = "⚑"
modified = "•"
staged = "[++($count)](green)"
renamed = "→"
deleted = "×"

# ===================================
# Compact Mode Overrides
# ===================================
# Overrides for compact mode - most modules disabled

# Directory configuration handled in core-overridable.toml


# GitHub username settings handled in github-modules.toml

# System username disabled - using GitHub username instead

# Hostname disabled for compact mode

# Shell level disabled for compact mode

[package]
disabled = true

[golang]
disabled = true

[python]
disabled = true

[nodejs]
disabled = true

[rust]
disabled = true

[java]
disabled = true

[docker_context]
disabled = true

[cmake]
disabled = true

[container]
disabled = true

[kubernetes]
disabled = true

[terraform]
disabled = true

[nix_shell]
disabled = true

[battery]
disabled = true

[time]
disabled = true

[localip]
disabled = true

# Custom modules - disable all for compact mode
[custom.terminal]
disabled = true

[custom.macos]
disabled = true

[custom.linux]
disabled = true

[custom.sway]
disabled = true

[custom.tmux]
disabled = true

[custom.ghostty]
disabled = true

[custom.foot]
disabled = true

[custom.git_commit]
disabled = true

[custom.aws_profile]
disabled = true

[custom.memory]
disabled = true

[custom.github_status]
disabled = true

# ===================================
# Configuration Notes
# ===================================
# This configuration is automatically generated from modular components:
# - formats/compact-format.toml: Format and basic settings
# - modules/*: Shared module configurations
# - modes/compact-overrides.toml: Mode-specific customizations
#
# To modify this configuration, edit the source files and run:
# $ ./build-configs.sh
